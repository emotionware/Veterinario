<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Proveedores</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- bootstrap theme -->
    <link rel="stylesheet" href="/static/themes/cerulean/bootstrap.css" media="screen">

    <!-- add one of the jQWidgets styles -->
    <link rel="stylesheet"
          href="/static/jqwidgets/styles/jqx.base.css" type="text/css" />

    <!-- Themes for jqwidget-->
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.darkblue.css" type="text/css" />
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.material.css" type="text/css" />
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.material-green.css" type="text/css" />
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.material-purple.css" type="text/css" />



    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.shinyblack.css" type="text/css" />

    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.ui-lightness.css" type="text/css" />
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.ui-start.css" type="text/css" />
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.ui-redmond.css" type="text/css" />
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.ui-sunny.css" type="text/css" />


    <!--Localization-->
    <script type="text/javascript" src="/static/jqwidgets/globalization/globalize.js"></script>



    <!-- add the jQuery script -->
    <script src="/static/scripts/jquery.min.js"></script>
    <!-- add the jQWidgets framework -->
    <script type="text/javascript" src="/static/jqwidgets/jqxcore.js"></script>
    <!-- add one or more widgets -->
    <script type="text/javascript" src="/static/jqwidgets/jqx-all.js"></script>


    <!--Js Demos-->
    <script type="text/javascript" src="/static/scripts/demos.js"></script>

    <!--Exportadores-->
    <script type="text/javascript" src="/static/jqwidgets/jqxgrid.selection.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxgrid.edit.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxgrid.columnsresize.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxdata.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxdata.export.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxgrid.export.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxexport.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxgrid.sort.js"></script>



    <!-- JSZip -->
    <script type="text/javascript" src="/static/scripts/jszip.min.js"></script>


    <!-- Cookie Control -->
    <script src="/static/scripts/js.cookie.js"></script>


    <script type="text/javascript" src="/static/jqwidgets/jqxdata.export.js"></script>


    <script type="text/javascript" src="/static/jqwidgets/jqxdata.js"></script>


    <style type="text/css">

        html, body {
            height: 100%;
            width: 100%;
            margin: 0px;
            padding: 0px;
            overflow: hidden;
        }
    </style>

    <style>


        @font-face {
            font-family: pompadour;
            src: url(/static/fonts/02_APompadourTextSample.ttf);
        }



        html {
            visibility: hidden;
        }
    </style>


    <style>


        a:link {
            color: white;
            text-decoration: none;
        }

        a:hover {
            color: oldlace;
            text-decoration: none;
        }

        button {
            border-radius: 4px;
        }
    </style>


    <script>


        theme = Cookies.get('theme');

        if (theme == null || theme == '' || theme == 'start') {

            Cookies.set('theme', 'darkblue', { expires: 90 });

        }








        $(document).ready(function () {
            document.getElementsByTagName("html")[0].style.visibility = "visible";
        });




        //check log in/////////////
        if (Cookies.get('username') != null && Cookies.get('esadmin') != null && Cookies.get('token') != null) {
            //Show the page

        }
        else {
            //Redirect to login
            window.open("login", "_self");
        }


    </script>


    <script type="text/javascript">
        $(document).ready(function () {



            // renderer for grid cells.
            var numberrenderer = function (row, column, value) {
                return '<div style="text-align: center; margin-top: 5px;">' + (1 + value) + '</div>';
            }
            // create Grid datafields and columns arrays.
            var datafields = [



                {name: 'IDPROVEEDOR', type: 'string'},{name: 'EMPRESA', type: 'string'},{name: 'NOMBRE', type: 'string'},{name: 'APELLIDO', type: 'string'},{name: 'PUESTO', type: 'string'},{name: 'DOMICILIO', type: 'string'},{name: 'COLONIA', type: 'string'},{name: 'CODIGO_POSTAL', type: 'string'},{name: 'CIUDAD', type: 'string'},{name: 'ESTADO', type: 'string'},{name: 'PAIS', type: 'string'},{name: 'OBSERVACIONES', type: 'string'},{name: 'ELIMINADO', type: 'bool'},{name: 'BLOQUEADO', type: 'bool'},{name: 'FECHAALTA', type: 'string'},{name: 'PROPIETARIO', type: 'string'}


            ];
        var columns = [



              {text: 'IDPROVEEDOR', datafield: 'IDPROVEEDOR', theme:theme ,  columntype: 'text' , width: '110'},{text: 'EMPRESA', datafield: 'EMPRESA', theme:theme ,  columntype: 'text' , width: '110'},{text: 'NOMBRE', datafield: 'NOMBRE', theme:theme ,  columntype: 'text' , width: '110'},{text: 'APELLIDO', datafield: 'APELLIDO', theme:theme ,  columntype: 'text' , width: '110'},{text: 'PUESTO', datafield: 'PUESTO', theme:theme ,  columntype: 'text' , width: '110'},{text: 'DOMICILIO', datafield: 'DOMICILIO', theme:theme ,  columntype: 'text' , width: '110'},{text: 'COLONIA', datafield: 'COLONIA', theme:theme ,  columntype: 'text' , width: '110'},{text: 'CODIGO_POSTAL', datafield: 'CODIGO_POSTAL', theme:theme ,  columntype: 'text' , width: '110'},{text: 'CIUDAD', datafield: 'CIUDAD', theme:theme ,  columntype: 'text' , width: '110'},{text: 'ESTADO', datafield: 'ESTADO', theme:theme ,  columntype: 'text' , width: '110'},{text: 'PAIS', datafield: 'PAIS', theme:theme ,  columntype: 'text' , width: '110'},{text: 'OBSERVACIONES', datafield: 'OBSERVACIONES', theme:theme ,  columntype: 'text' , width: '110'},{text: 'ELIMINADO', datafield: 'ELIMINADO', theme:theme , columntype: 'checkbox' , width: '110'},{text: 'BLOQUEADO', datafield: 'BLOQUEADO', theme:theme , columntype: 'checkbox' , width: '110'},{text: 'FECHAALTA', theme:theme  ,datafield: 'FECHAALTA', theme:theme ,  columntype: 'string' , width: '110'},{text: 'PROPIETARIO', datafield: 'PROPIETARIO', theme:theme ,  columntype: 'text' , width: '110'}


        ];
            for (var i = 0; i < 26; i++) {
                var text = String.fromCharCode(65 + i);
                if (i == 0) {
                    var cssclass = 'jqx-widget-header';
                    if (theme != '') cssclass += ' jqx-widget-header-' + theme;
                    columns[columns.length] = { pinned: true, exportable: false, text: "", columntype: 'number', cellclassname: cssclass, cellsrenderer: numberrenderer };
                }
                datafields[datafields.length] = { name: text };
                columns[columns.length] = { text: text, datafield: text, width: 60, align: 'center' };
            }
            var source =
            {
                unboundmode: true,
                totalrecords: 100,
                datafields: datafields,
                updaterow: function (rowid, rowdata) {
                    // synchronize with the server - send update command
                }
            };
            var dataAdapter = new $.jqx.dataAdapter(source);
            // initialize jqxGrid
            $("#grid").jqxGrid(
                {
                    width: '100%',
                    height:'450',
                    source: dataAdapter,
                    editable: true,
                    columnsresize: true,
                    selectionmode: 'multiplecellsadvanced',
                    columns: columns
                });

        var linkrenderer = function (row, column, value) {
            if (value.indexOf('#') != -1) {
                value = value.substring(0, value.indexOf('#'));
            }
            var format = { target: '"_blank"', style: 'border-radius: 4px;' };
            var html = $.jqx.dataFormat.formatlink(value, format);
            return html;
        }



        $("#grid").on('cellendedit', function (event) {
            // event arguments.
            var args = event.args;
            // column data field.
            var dataField = event.args.datafield;
            // row's bound index.
            var rowBoundIndex = event.args.rowindex;
            // cell value
            var value = args.value;
            // cell old value.
            var oldvalue = args.oldvalue;
            // row's data.
            var rowData = args.row;

            var elvalor = '';

            if (dataField == 'IDPROVEEDOR' && value!=null  ) {

                //leer datos en la fila - volcar 

$.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  EMPRESA  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "EMPRESA", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  NOMBRE  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "NOMBRE", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  APELLIDO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "APELLIDO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  EMAIL  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "EMAIL", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  CELULAR  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "CELULAR", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  PUESTO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "PUESTO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  DOMICILIO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "DOMICILIO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  COLONIA  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "COLONIA", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  CODIGO_POSTAL  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "CODIGO_POSTAL", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  CIUDAD  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "CIUDAD", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  ESTADO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "ESTADO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  PAIS  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "PAIS", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  OBSERVACIONES  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "OBSERVACIONES", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  ELIMINADO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "ELIMINADO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  BLOQUEADO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "BLOQUEADO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  concat(FECHAALTA,' +06:00' ) from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "FECHAALTA", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });   $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  PROPIETARIO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "PROPIETARIO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });   


              //  $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "NOMBRE_TAREA",'CAPULLO'  ); 
       

            }

        });





            var url_string = window.location.href;
            var url = new URL(url_string);
            var indices = url.searchParams.get("indices");
            
        if (indices != null) {

            //precargando
               partes = String(indices).split(",");



               var arrayLength = partes.length;
               for (var i = 0; i < arrayLength; i++) {
                   console.log(partes[i]);

                   var rowID = $('#grid').jqxGrid('getrowid', partes[i]);
                   var data = $('#grid').jqxGrid('getrowdatabyid', rowID);

                  $("#grid").jqxGrid('setcellvalue', i, "IDPROVEEDOR", partes[i]);

                   var value = partes[i];
                   var rowBoundIndex = i;


                   $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  EMPRESA  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "EMPRESA", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  NOMBRE  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "NOMBRE", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  APELLIDO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "APELLIDO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  EMAIL  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "EMAIL", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  CELULAR  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "CELULAR", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  PUESTO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "PUESTO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  DOMICILIO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "DOMICILIO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  COLONIA  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "COLONIA", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  CODIGO_POSTAL  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "CODIGO_POSTAL", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  CIUDAD  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "CIUDAD", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  ESTADO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "ESTADO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  PAIS  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "PAIS", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  OBSERVACIONES  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "OBSERVACIONES", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  ELIMINADO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "ELIMINADO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  BLOQUEADO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "BLOQUEADO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  concat(FECHAALTA,' +06:00' ) from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "FECHAALTA", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });   $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  PROPIETARIO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "PROPIETARIO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });   


            }



        }






        $("#Afectar").jqxButton({ theme: theme });
        $("#Afectar").click(function () {

            //parse files check if there is any selected field inside
            var cells = $('#grid').jqxGrid('getselectedcells');

            var cellInfo = "";
            for (var i = 0; i < cells.length; i++) {
                var cell = cells[i];
              //  cellInfo += "\nRow: " + cell.rowindex + ", " + cell.datafield;

                //check if first columnd of every selected row is empty

                var valorid= $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'IDPROVEEDOR');
                var value = $('#grid').jqxGrid('getcellvalue', cell.rowindex, cell.datafield);


                if (valorid == '') {
                    //insert
                   // alert('insert' + cell.rowindex);




                      var cadenainsert = '';
                    cadenainsert = cadenainsert + ' insert into tblproveedor (EMPRESA,NOMBRE,APELLIDO,EMAIL,CELULAR,PUESTO,DOMICILIO,COLONIA,CODIGO_POSTAL,CIUDAD,ESTADO,PAIS,OBSERVACIONES,ELIMINADO,BLOQUEADO,FECHAALTA,PROPIETARIO) values (';

                    cadenainsert = cadenainsert + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'EMPRESA') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'NOMBRE') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'APELLIDO') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'EMAIL') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'CELULAR') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'PUESTO') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'DOMICILIO') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'COLONIA') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'CODIGO_POSTAL') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'CIUDAD') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'ESTADO') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'PAIS') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'OBSERVACIONES') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'ELIMINADO') + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'BLOQUEADO') + "'" + ","  + "'" + formatDate( new Date( checarnulos( 'date',   $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'FECHAALTA')) ).toISOString() )  + "'" + ","  + "'" + $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'PROPIETARIO') + "'" + ","  ;

               // cadenainsert = cadenainsert + ' where IDPROVEEDOR=' + $('#grid').jqxGrid('getcellvalue', cell.rowindex, "IDPROVEEDOR");


                cadenainsert = cadenainsert + ')';

                cadenainsert = cadenainsert.replace(',)', ')');

                cadenainsert = cadenainsert.replace("'undefined'", "Null");
               
                console.log(cadenainsert);

               


                //guardando
                $.ajax({
                     async:false,
                    url: "/sqlexec2" + '?idusername=' + Cookies.get('idusername') + '&tablename=tblproveedor&sentencia=' + cadenainsert
                }).then(function (data) {

                     //recuperando el id para la primer columna
                    $("#grid").jqxGrid('setcellvalue', cell.rowindex, "IDPROVEEDOR", data);


                     $('#mensaje').val(data);


                    //recuperando datos
                    var value = data;
                var rowBoundIndex = cell.rowindex;
                    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  EMPRESA  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "EMPRESA", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  NOMBRE  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "NOMBRE", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  APELLIDO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "APELLIDO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  EMAIL  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "EMAIL", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  CELULAR  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "CELULAR", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  PUESTO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "PUESTO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  DOMICILIO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "DOMICILIO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  COLONIA  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "COLONIA", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  CODIGO_POSTAL  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "CODIGO_POSTAL", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  CIUDAD  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "CIUDAD", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  ESTADO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "ESTADO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  PAIS  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "PAIS", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  OBSERVACIONES  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "OBSERVACIONES", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  ELIMINADO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "ELIMINADO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  BLOQUEADO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "BLOQUEADO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });    $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  concat(FECHAALTA,' +06:00' ) from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "FECHAALTA", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });   $.ajax({async: false,url: "/obtenervalor" + "?sentencia=select  PROPIETARIO  from tblproveedor where IDPROVEEDOR=" + value }).then(function (data) { $("#grid").jqxGrid('setcellvalue', rowBoundIndex, "PROPIETARIO", String(data).replace("None",""));  $("#mensaje").val("Leyendo registros...espere..." + data);     });   



                });



                $('#mensaje').val('Guardado Terminado');



                }

                if (valorid != '') {
                    //update

                    //  alert('update' + cell.rowindex);


                    var cadenaupdate = '';
                    cadenaupdate = cadenaupdate + ' update tblproveedor set ';

                    cadenaupdate = cadenaupdate + 'EMPRESA=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'EMPRESA')).replace('null','').replace('undefined','') + "'" + ","  + 'NOMBRE=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'NOMBRE')).replace('null','').replace('undefined','') + "'" + ","  + 'APELLIDO=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'APELLIDO')).replace('null','').replace('undefined','') + "'" + ","  + 'EMAIL=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'EMAIL')).replace('null','').replace('undefined','') + "'" + ","  + 'CELULAR=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'CELULAR')).replace('null','').replace('undefined','') + "'" + ","  + 'PUESTO=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'PUESTO')).replace('null','').replace('undefined','') + "'" + ","  + 'DOMICILIO=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'DOMICILIO')).replace('null','').replace('undefined','') + "'" + ","  + 'COLONIA=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'COLONIA')).replace('null','').replace('undefined','') + "'" + ","  + 'CODIGO_POSTAL=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'CODIGO_POSTAL')).replace('null','').replace('undefined','') + "'" + ","  + 'CIUDAD=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'CIUDAD')).replace('null','').replace('undefined','') + "'" + ","  + 'ESTADO=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'ESTADO')).replace('null','').replace('undefined','') + "'" + ","  + 'PAIS=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'PAIS')).replace('null','').replace('undefined','') + "'" + ","  + 'OBSERVACIONES=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'OBSERVACIONES')).replace('null','').replace('undefined','') + "'" + ","  + 'ELIMINADO=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'ELIMINADO')).replace('null','').replace('undefined','') + "'" + ","  + 'BLOQUEADO=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'BLOQUEADO')).replace('null','').replace('undefined','') + "'" + ","  + 'FECHAALTA=' + "'" + formatDate( new Date( $('#grid').jqxGrid('getcellvalue', cell.rowindex, 'FECHAALTA')  ).toISOString() )  + "'" + ","  + 'PROPIETARIO=' + "'" + String($('#grid').jqxGrid('getcellvalue', cell.rowindex, 'PROPIETARIO')).replace('null','').replace('undefined','') + "'" + ","  ;

                cadenaupdate = cadenaupdate + ' where IDPROVEEDOR=' + $('#grid').jqxGrid('getcellvalue', cell.rowindex, "IDPROVEEDOR");

            cadenaupdate = cadenaupdate.replace(', where', ' where ');




            cadenaupdate = cadenaupdate.replace("=''", "=Null");


                console.log(cadenaupdate);


                

                //guardando
            $.ajax({
                     async:false,
                    url: "/sqlexec" + '?idobjeto=' + valorid + '&tablename=tblproveedor&sentencia=' + cadenaupdate
                }).then(function (data) {

                    var res = data;

                    $('#mensaje').val('Afectando ID ' + valorid);

                });



            }


             $('#mensaje').val('Guardado Terminado');

        }

        });






        });

        function checarnulos(tipo,valor) {

            if (tipo == 'date') {

                if (valor == null || valor=='') {

                    return '1970-01-01T12:00:00Z';
                    
            }

            }

           
            if (tipo != 'date') {

                if (valor == null) {

                    return '';
                    
            }

            }


        }


 function formatDate(date) {
    var d = new Date(date),
        month = '' + (d.getMonth() + 1),
        day = '' + d.getDate(),
        year = d.getFullYear();

    if (month.length < 2) month = '0' + month;
    if (day.length < 2) day = '0' + day;

    return [year, month, day].join('-');
}


    </script>

</head>
<body class='default'>


    <div id="zonamenu">
        <div id='jqxMenu'>
    <ul>
    	 
    	
        <li><a href="javascript:addtabplustitle('home','Home')">Home</a></li>
        
         
          
         
        
        
        
        
         <li>Clientes
         <ul>
         	<li><a href="javascript:addtabplus('rendergrid?grid=tables/tblprospecto')">Clientes</a></li>
         	<li>Vistas
         	<ul>
         		 
         	<li><a href="javascript:addtabplus('/static/stimulsoft/reportviewer.html?reporte=view_estatus_prospectos.mrt')">Estatus</a></li>
         		<li><a href="javascript:addtabplus('/static/stimulsoft/reportviewer.html?reporte=view_ver_origenes.mrt')">Origenes</a></li>
         	</ul>
         	</li>
         </ul>
         
         </li>
          
          
          
          
          <li>Ventas
         <ul>
         	<li><a href="javascript:addtabplus('rendergrid?grid=tables/tblcotizacion')">Ventas</a></li>
         	<li>Vistas
         	<ul>
         		<li><a href="javascript:addtabplus('static/stimulsoft/reportviewer.html?reporte=view_estatus_tblcotizacion.mrt')">Estatus</a></li>
          	<li><a href="javascript:addtabplus('static/stimulsoft/reportviewer.html?reporte=view_canal_comercial.mrt')">Canales Comerciales</a></li>
         	</ul>
         	</li>
         </ul>
         </li>
          
          <li>Almacenes
          <ul>
          	 <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblalmacen')">Almacén</a></li>
          	  <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblcompraenca')">Compras</a></li>
          	 <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblarticulo')">Artículos</a></li>
          	  <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblentrada')">Entradas</a></li>
          	   <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblsalida')">Salidas</a></li>
          	    <li><a href="javascript:addtabplus('rendergrid?grid=tables/tbltipoentrada')">Tipo Entrada</a></li>
          	     <li><a href="javascript:addtabplus('rendergrid?grid=tables/tbltiposalida')">Tipo Salida</a></li>
          	      <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblkardex')">Kardex</a></li>
          	           <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblproveedor')">Proveedores</a></li>
          </ul>
          </li>
          
        
            <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblagente')">Agentes</a></li>
          
              <li><a href="javascript:addtabplus('rendergrid?grid=tables/tbldocumento')">Documentos</a></li>
             
             
             
             <li>Reportes Vet
             
             <ul>
             	
   <li><a href="javascript:addtabplus('/static/stimulsoft/reportviewer.html?reporte=view_existencia_general')">Existencia General</a></li>
<li><a href="javascript:addtabplus('/static/stimulsoft/reportviewer.html?reporte=view_existencias_por_lote')">Existencia por Lotes</a></li>
<li><a href="javascript:addtabplus('/static/stimulsoft/dashboardviewer.html?dashboard=view_analisis_caducidad')">Análisis de la Caducidad</a></li> 
           
           
           
           
             </ul>
             
             </li>
             
             
           
             <li>Config
             <ul>
  <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblmascota')">Mascota</a></li>                	
 <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblespecie')">Especie</a></li>   
 <li><a href="javascript:addtabplus('rendergrid?grid=tables/tblraza')">Raza</a></li>   

  
             </ul>
             </li>             
             
             
           <li>Reportes
           <ul>
           	<li><a href="javascript:addtabplus('/static/stimulsoft/reportviewer.html?reporte=view_recordatorios.mrt')" >Recordatorios</a></li>
           	<li><a href="javascript:addtabplus('/static/stimulsoft/reportviewer.html?cuerpo=&asunto=&para=&reporte=catalogoarticulos.mrt')" >Catálogo Artículos</a></li>
           <li><a href="javascript:addtabplus('/static/stimulsoft/reportviewer.html?cuerpo=&asunto=&para=&reporte=vtascerradas.mrt')" >Vtas Cerradas</a></li>
           <li><a href="javascript:addtabplus('/static/stimulsoft/reportviewer.html?cuerpo=&asunto=&para=&reporte=deudaactiva.mrt')" >Deuda Activa</a></li>
           <li><a href="javascript:addtabplus('/static/stimulsoft/dashboardviewer.html?dashboard=productividad.mrt')" >Productividad</a></li>
        <li><a href="javascript:addtabplus('/static/pivot/index.html?query=view_reporte_cotizacion&perspectiva=general')" target="_blank" >Pivot Gral Operaciones</a></li>
        
           
           </ul>
           </li>
       
         	<li><a href="javascript:addtabplus('adminzone')">Admin Zona</a></li>
         	<li><a href="javascript:addtabplus('login')">Login</a></li>
            </ul>
        </li>
     
     
      
        
      
    </ul>
</div>


<script type="text/javascript">


    theme = Cookies.get('theme');

    if (theme == null || theme == '' || theme == 'start') {

        Cookies.set('theme', 'darkblue', { expires: 90 });

    }

    


    $(document).ready(function () {
        $("#jqxMenu").jqxMenu({ width: '100%', height: '30px', theme: theme });
        var centerItems = function () {
            var firstItem = $($("#jqxMenu ul:first").children()[0]);
            firstItem.css('margin-left', 0);
            var width = 0;
            var borderOffset = 2;
            $.each($("#jqxMenu ul:first").children(), function () {
                width += $(this).outerWidth(true) + borderOffset;
            });
            var menuWidth = $("#jqxMenu").outerWidth();
            firstItem.css('margin-left', (menuWidth / 2) - (width / 2));
        }
        centerItems();
        $(window).resize(function () {
            centerItems();
        });
    });
</script>
    </div>


    <div id='jqxWidget'>
        <div id="encabezado">

            <input id="mensaje" type="text" style="width:100%;height:20px;"  />

        </div>
        <div id="grid"></div>
        <div style='margin-top: 20px;'>
            <div style='float: left;'>
               

                <input type="button" value="Afectar" id='Afectar' />
            </div>
        </div>
    </div>
</body>
</html>