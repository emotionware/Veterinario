<!DOCTYPE html>

<html lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Formulario de Cotización/Venta</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- bootstrap theme -->
    <link rel="stylesheet" href="/static/themes/cerulean/bootstrap.css" media="screen">

    <!-- add one of the jQWidgets styles -->
    <link rel="stylesheet"
          href="/static/jqwidgets/styles/jqx.base.css" type="text/css" />

    <!-- Themes for jqwidget-->
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.darkblue.css" type="text/css" />




    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.shinyblack.css" type="text/css" />

    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.ui-lightness.css" type="text/css" />
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.ui-start.css" type="text/css" />
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.ui-redmond.css" type="text/css" />
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.ui-sunny.css" type="text/css" />
    <link rel="stylesheet" href="/static/jqwidgets/styles/jqx.ui-le-frog.css" type="text/css" />

    <!--Localization-->
    <script type="text/javascript" src="/static/jqwidgets/globalization/globalize.js"></script>

    <!-- add the jQuery script -->
    <script src="/static/scripts/jquery.min.js"></script>
    <!-- add the jQWidgets framework -->
    <script type="text/javascript" src="/static/jqwidgets/jqxcore.js"></script>
    <!-- add one or more widgets -->
    <script type="text/javascript" src="/static/jqwidgets/jqx-all.js"></script>

    <!-- add one or more widgets -->
    <script type="text/javascript" src="/static/scripts/moment.js"></script>

    <!--Localization-->
    <script type="text/javascript" src="/static/simulate/libs/bililiteRange.js"></script>
    <script type="text/javascript" src="/static/simulate/libs/jquery.simulate.js"></script>
    <script type="text/javascript" src="/static/simulate/src/jquery.simulate.drag-n-drop.js"></script>
    <script type="text/javascript" src="/static/simulate/src/jquery.simulate.ext.js"></script>
    <script type="text/javascript" src="/static/simulate/src/jquery.simulate.key-combo.js"></script>
    <script type="text/javascript" src="/static/simulate/src/jquery.simulate.key-sequence.js"></script>



    <!-- Add the stylesheet to the head -->
<link rel="stylesheet" type="text/css" href="/static/clippy/build/clippy.css" media="all">

<!-- Clippy.js -->
<script src="/static/clippy/build/clippy.min.js"></script>



    <style>
        iframe{
    overflow:hidden;
}
    </style>

    <style>


        @font-face {
            font-family: pompadour;
            src: url('/static/fonts/02_APompadourTextSample.ttf');
        }


        .ocultar {
            visibility: hidden;
            display: none
        }

        .ajustarposicion {
            position: relative;
            left: 10px;
        }

        html {
            visibility: hidden;
        }


    </style>

    <!--Js Demos-->
    <script type="text/javascript" src="/static/scripts/demos.js"></script>

    <!--Exportadores-->
    <script type="text/javascript" src="/static/jqwidgets/jqxgrid.selection.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxgrid.columnsresize.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxdata.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxdata.export.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxgrid.export.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxexport.js"></script>
    <script type="text/javascript" src="/static/jqwidgets/jqxgrid.sort.js"></script>

    <!-- JSZip -->
    <script type="text/javascript" src="/static/scripts/jszip.min.js"></script>

    <!-- Cookie Control -->
    <script src="/static/scripts/js.cookie.js"></script>

    <script type="text/javascript" src="/static/jqwidgets/jqxdata.export.js"></script>

    <script type="text/javascript" src="/static/jqwidgets/jqxdata.js"></script>

   
		<script type='text/javascript'>

			var eldestino='';
		var recognition = new webkitSpeechRecognition();
		recognition.onresult = function(event) {
			console.log('result');
		  	var saidText = "";
		  	for (var i = event.resultIndex; i < event.results.length; i++) {
		        if (event.results[i].isFinal) {
		            saidText = event.results[i][0].transcript;
		        } else {
		            saidText += event.results[i][0].transcript;
		        }
		    }


if (eldestino=='action'){

                 $.ajax({
                        url: "/voiceaction" + '?voice=' + saidText
                    }).then(function (data) {

//window.open(data,'_self');
window.parent.parent.addtabplus(data);

                    });

} else{





            if( document.getElementById(eldestino).getAttribute("type")==null  ) {
    try {
       document.getElementById(eldestino + "TextArea").value = document.getElementById(eldestino + "TextArea").value + ' ' + saidText;
      }
    catch ( e ) {
          $('#' + eldestino + '.jqx-input').jqxNumberInput('val', saidText  );
      }

            }
                else
            {
                document.getElementById(eldestino).value = saidText;

            }


       }





		}


		function startRecording(destino){
			eldestino=destino;
			recognition.start();
		}





		</script>


    <script>





        //validando permisos
        $(document).ready(function () {
            $.ajax({
                url: "/validaracceso" + '?idusername=' + Cookies.get('idusername') + '&tablename=tblcotizacion'
            }).then(function (data) {


                //checando que hacer
                if (data == '00') {

                    //Redirect to no autorizaddo
                    window.open("noautorizado?tablename=tblcotizacion", "_self");
                }

                if (data == '10') {
                    // alert('MOSTRAR Y NO GUARDAR');
                    aviso("SOLO TIENE PERMISO DE LECTURA EN ESTA PÁGINA");

                    //deshabilitar botón guardar
                    document.getElementById("tablabotones").style.visibility = "hidden";
                    document.getElementById("elimregs").style.visibility = "hidden";
                }

                if (data == '11') {
                    // alert('MOSTRAR Y GUARDAR');
                }

                if (data == '01') {

                    //Redirect to no autorizaddo
                    window.open("noautorizado?tablename=tblcotizacion", "_self");
                }

            });
        });




        //Cargando datos del objeto
        var url_string = window.location.href;
        var url = new URL(url_string);
        var idobjeto = url.searchParams.get("idobjeto");



        if (idobjeto != null && idobjeto != 'null'  && idobjeto != ''  && idobjeto != ' '  ) {
        //validando permisos de pertenencia a estructura de grupos
        $(document).ready(function () {
            $.ajax({                

                url: "/validapropiedad" + '?idobjeto=' + idobjeto + '&tipouser=' + Cookies.get('tipouser') + '&idusername=' + Cookies.get('idusername') + '&esadmin=' + Cookies.get('esadmin') + '&tablename=tblcotizacion'

            }).then(function (data) {


                

                if (data == '0') {

                    //Redirect to no autorizaddo
                    window.open("noautorizado?tablename=tblcotizacion", "_self");

                }
 

            });
        });
        }

















        theme = Cookies.get('theme');

          if (theme == null || theme == '' || theme == 'start') {

             Cookies.set('theme', 'darkblue', { expires: 90 });

        }





        //check log in/////////////
        if (Cookies.get('username') != null && Cookies.get('esadmin') != null && Cookies.get('token') != null) {
            //Show the page

        }
        else {
            //Redirect to login
            window.open("login", "_self");
        }




        //check ADMIN/////////////
        soloadmin = '';
        if (soloadmin == 'true' && Cookies.get('esadmin') != '1') {

            //Redirect to no autorizaddo
            window.open("noautorizado?tablename=tblcotizacion", "_self");

        };




        //validando TOKEN  Cookies.get('token')
             $(document).ready(function () {
                 $.ajax({
                        url: "/validartoken" + '?token=' + Cookies.get('token')
                    }).then(function (data) {

                       // if (data=='valido'){}

                     if (data=='novalido'){
                            window.open("login", "_self");
                        }

                    });
                 });








function simulateWrapper(target, type, options) {

            switch (type) {
                case "key-sequence":
                    options.delay = $('#sequence-delay').val();
                    break;
                case "drag":
                case "drag-n-drop":
                    logMouseMove = true;
                    var interpolationType = $('#drag-interpolation-type').val(),
                        delayType = $('#drag-delay-type').val();
                    var shakyValue = $('#drag-shaky').val();
                    options.interpolation = {
                        shaky: (shakyValue.toLowerCase() === "true") ? true : parseInt(shakyValue)
                    };
                    options.interpolation[interpolationType] = $('#drag-interpolation').val();
                    options.interpolation[delayType] = $('#drag-delay').val();
                    break;
            }

            //$eventLog.append("####### Simulating "+type+" #######");
            //$eventLog.incIndentation();

            function simulationEnd() {
                logMouseMove = false;
                //$eventLog.decIndentation();
                //$eventLog.append("################################");
            }

            switch (type) {
                case "key-sequence":

                    $(document).one("simulate-keySequence", simulationEnd);
                    break;
                case "drag":
                    $(document).one("simulate-drag", simulationEnd);
                    break;
                case "drag-n-drop":
                case "drop":
                    $(document).one("simulate-drop", simulationEnd);
                    break;
            }

            $(target).simulate(type, options);

            if (type === "key-combo") {
                simulationEnd();
            }
        }



    </script>






  






    




<script>
  
</script>




</head>
<body>



    <script>

        function cargardatos() {
             //Cargando datos del objeto
            var url_string = window.location.href;
            var url = new URL(url_string);
            var idobjeto = url.searchParams.get("idobjeto");

            if (idobjeto != null) {

                        var gjson;
                        gjson = getJSON("getidobject?tabla=tblcotizacion&idobjeto=" + idobjeto);

                        obj = JSON.parse(gjson);

                          //asignando valores a los objetos cliente

                             $('#IDCOTIZACION').jqxInput('val',  obj['IDCOTIZACION']);
$('#IDPROSPECTO').jqxInput('val',  obj['IDPROSPECTO']);
 $(document).ready(function () {$.ajax({ url: '/quierodisplay' + '?idobjeto=' +  obj['IDPROSPECTO'] + '&tablename=' + 'tblPROSPECTO' }).then(function (data) {document.getElementById('bottom_IDPROSPECTO').innerHTML = data;});}); 
  $('#IDESTATUS_tblcotizacion').jqxInput('val',  obj['IDESTATUS_tblcotizacion']);
 $(document).ready(function () {$.ajax({ url: '/quierodisplay' + '?idobjeto=' +  obj['IDESTATUS_tblcotizacion'] + '&tablename=' + 'tblESTATUS_tblcotizacion' }).then(function (data) {document.getElementById('bottom_IDESTATUS_tblcotizacion').innerHTML = data;});}); 
  $('#PROCESADO').jqxCheckBox('val',  obj['PROCESADO']);
var date_FECHA=new Date(obj['FECHA']);
 date_FECHA.setDate(date_FECHA.getDate() + 1);    
  $('#FECHA').jqxDateTimeInput({value: date_FECHA  });
$('#OBSERVACIONES').jqxTextArea('val',  obj['OBSERVACIONES']);
var number_SUBTOTAL=obj['SUBTOTAL'];
  if (number_SUBTOTAL==null) {number_SUBTOTAL=0}    
  $('#SUBTOTAL').jqxNumberInput('val', number_SUBTOTAL  );
 $('#bottom_SUBTOTAL').html( numberWithCommas(obj['SUBTOTAL']) );var number_IMPORTE_IVA=obj['IMPORTE_IVA'];
  if (number_IMPORTE_IVA==null) {number_IMPORTE_IVA=0}    
  $('#IMPORTE_IVA').jqxNumberInput('val', number_IMPORTE_IVA  );
 $('#bottom_IMPORTE_IVA').html( numberWithCommas(obj['IMPORTE_IVA']) );var number_TOTAL=obj['TOTAL'];
  if (number_TOTAL==null) {number_TOTAL=0}    
  $('#TOTAL').jqxNumberInput('val', number_TOTAL  );
 $('#bottom_TOTAL').html( numberWithCommas(obj['TOTAL']) );$('#IDCANALCOMERCIAL').jqxInput('val',  obj['IDCANALCOMERCIAL']);
 $(document).ready(function () {$.ajax({ url: '/quierodisplay' + '?idobjeto=' +  obj['IDCANALCOMERCIAL'] + '&tablename=' + 'tblCANALCOMERCIAL' }).then(function (data) {document.getElementById('bottom_IDCANALCOMERCIAL').innerHTML = data;});}); 
  $('#ELIMINADO').jqxCheckBox('val',  obj['ELIMINADO']);
$('#BLOQUEADO').jqxCheckBox('val',  obj['BLOQUEADO']);
var date_FECHAALTA=new Date(obj['FECHAALTA']);
 date_FECHAALTA.setDate(date_FECHAALTA.getDate() + 1);    
  $('#FECHAALTA').jqxDateTimeInput({value: date_FECHAALTA  });
$('#PROPIETARIO').jqxInput('val',  obj['PROPIETARIO']);
var number_TOTAL_ABONOS=obj['TOTAL_ABONOS'];
  if (number_TOTAL_ABONOS==null) {number_TOTAL_ABONOS=0}    
  $('#TOTAL_ABONOS').jqxNumberInput('val', number_TOTAL_ABONOS  );
 $('#bottom_TOTAL_ABONOS').html( numberWithCommas(obj['TOTAL_ABONOS']) );var number_TOTAL_ADEUDO=obj['TOTAL_ADEUDO'];
  if (number_TOTAL_ADEUDO==null) {number_TOTAL_ADEUDO=0}    
  $('#TOTAL_ADEUDO').jqxNumberInput('val', number_TOTAL_ADEUDO  );
 $('#bottom_TOTAL_ADEUDO').html( numberWithCommas(obj['TOTAL_ADEUDO']) );

                            /*creando el nombre del campo llave de esta tabla en Js
                            var elnombre ='tblcotizacion'
                            elnombre = elnombre.replace("tbl", "");
                            elnombre = "ID" + elnombre
                            elnombre = elnombre.toUpperCase();*/

                             $('#IDOBJECT').jqxInput('val', idobjeto);
                }
        }

                function cargardatos2(elobjeto) {
            var idobjeto = elobjeto;

            if (idobjeto != null) {

                        var gjson;
                        gjson = getJSON("getidobject?tabla=tblcotizacion&idobjeto=" + idobjeto);

                        obj = JSON.parse(gjson);

                          //asignando valores a los objetos cliente

                             $('#IDCOTIZACION').jqxInput('val',  obj['IDCOTIZACION']);
$('#IDPROSPECTO').jqxInput('val',  obj['IDPROSPECTO']);
 $(document).ready(function () {$.ajax({ url: '/quierodisplay' + '?idobjeto=' +  obj['IDPROSPECTO'] + '&tablename=' + 'tblPROSPECTO' }).then(function (data) {document.getElementById('bottom_IDPROSPECTO').innerHTML = data;});}); 
  $('#IDESTATUS_tblcotizacion').jqxInput('val',  obj['IDESTATUS_tblcotizacion']);
 $(document).ready(function () {$.ajax({ url: '/quierodisplay' + '?idobjeto=' +  obj['IDESTATUS_tblcotizacion'] + '&tablename=' + 'tblESTATUS_tblcotizacion' }).then(function (data) {document.getElementById('bottom_IDESTATUS_tblcotizacion').innerHTML = data;});}); 
  $('#PROCESADO').jqxCheckBox('val',  obj['PROCESADO']);
var date_FECHA=new Date(obj['FECHA']);
 date_FECHA.setDate(date_FECHA.getDate() + 1);    
  $('#FECHA').jqxDateTimeInput({value: date_FECHA  });
$('#OBSERVACIONES').jqxTextArea('val',  obj['OBSERVACIONES']);
var number_SUBTOTAL=obj['SUBTOTAL'];
  if (number_SUBTOTAL==null) {number_SUBTOTAL=0}    
  $('#SUBTOTAL').jqxNumberInput('val', number_SUBTOTAL  );
 $('#bottom_SUBTOTAL').html( numberWithCommas(obj['SUBTOTAL']) );var number_IMPORTE_IVA=obj['IMPORTE_IVA'];
  if (number_IMPORTE_IVA==null) {number_IMPORTE_IVA=0}    
  $('#IMPORTE_IVA').jqxNumberInput('val', number_IMPORTE_IVA  );
 $('#bottom_IMPORTE_IVA').html( numberWithCommas(obj['IMPORTE_IVA']) );var number_TOTAL=obj['TOTAL'];
  if (number_TOTAL==null) {number_TOTAL=0}    
  $('#TOTAL').jqxNumberInput('val', number_TOTAL  );
 $('#bottom_TOTAL').html( numberWithCommas(obj['TOTAL']) );$('#IDCANALCOMERCIAL').jqxInput('val',  obj['IDCANALCOMERCIAL']);
 $(document).ready(function () {$.ajax({ url: '/quierodisplay' + '?idobjeto=' +  obj['IDCANALCOMERCIAL'] + '&tablename=' + 'tblCANALCOMERCIAL' }).then(function (data) {document.getElementById('bottom_IDCANALCOMERCIAL').innerHTML = data;});}); 
  $('#ELIMINADO').jqxCheckBox('val',  obj['ELIMINADO']);
$('#BLOQUEADO').jqxCheckBox('val',  obj['BLOQUEADO']);
var date_FECHAALTA=new Date(obj['FECHAALTA']);
 date_FECHAALTA.setDate(date_FECHAALTA.getDate() + 1);    
  $('#FECHAALTA').jqxDateTimeInput({value: date_FECHAALTA  });
$('#PROPIETARIO').jqxInput('val',  obj['PROPIETARIO']);
var number_TOTAL_ABONOS=obj['TOTAL_ABONOS'];
  if (number_TOTAL_ABONOS==null) {number_TOTAL_ABONOS=0}    
  $('#TOTAL_ABONOS').jqxNumberInput('val', number_TOTAL_ABONOS  );
 $('#bottom_TOTAL_ABONOS').html( numberWithCommas(obj['TOTAL_ABONOS']) );var number_TOTAL_ADEUDO=obj['TOTAL_ADEUDO'];
  if (number_TOTAL_ADEUDO==null) {number_TOTAL_ADEUDO=0}    
  $('#TOTAL_ADEUDO').jqxNumberInput('val', number_TOTAL_ADEUDO  );
 $('#bottom_TOTAL_ADEUDO').html( numberWithCommas(obj['TOTAL_ADEUDO']) );

                            /*creando el nombre del campo llave de esta tabla en Js
                            var elnombre ='tblcotizacion'
                            elnombre = elnombre.replace("tbl", "");
                            elnombre = "ID" + elnombre
                            elnombre = elnombre.toUpperCase();*/

                             $('#IDOBJECT').jqxInput('val', idobjeto);
                }
        }

         function getJSON(url) {
        var resp ;
        var xmlHttp ;

        resp  = '' ;
        xmlHttp = new XMLHttpRequest();

        if(xmlHttp != null)
        {
            xmlHttp.open( "GET", url, false );
            xmlHttp.send( null );
            resp = xmlHttp.responseText;

            resp = resp.substring(1);
            resp = resp.substring(0, resp.length - 2);

        }

        return resp ;
        }

        function convertJson(formData){
            var unindexed_array = formData;
            var indexed_array = {};

            $.map(unindexed_array, function(n, i){
                indexed_array[n['name']] = n['value'];
            });

            return indexed_array;
        }

        function replaceAll(str, find, replace) {
    return str.replace(new RegExp(find, 'g'), replace);
        }

        $(document).ready(function () {
$('#theform').on('validationSuccess', function (event) {
    toJson();
});
});
        function procesarguardado() {

            if ($('#BLOQUEADO').val() != true) {

                $('#theform').jqxValidator('validate');

            } else {

                aviso('Registro Bloqueado - No puede modificarse');

            }

        }

         function procesarguardado2() {

                $('#theform').jqxValidator('validate');

        }

        function aviso(mensaje) {

                document.getElementById('textonotificacion').innerHTML = mensaje;
                $("#notificar").jqxNotification("open");

        }

        function toJson() {

            var obj = [];

            $('#theform input, #theform textarea, #theform select').each(
				function(index){
								var input = $(this);

					laclave = input.attr('name');
                    lakey = input.val();

                    if (typeof lakey != 'object') {
                          if (lakey.includes("'")){
								        var newval='';
								        newval=replaceAll(lakey,"'","_aptphe_");
								        newval=replaceAll(lakey,"&","_and_");
								        lakey=newval;
                            }

                           if (moment(lakey, "DD/MM/YYYY", true).isValid()) {

						         lakey = lakey.replace(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/, "$3-$2-$1");

                            }

}

                     var objTEMP = {};

                    if (typeof lakey === 'string') {

                        objTEMP[laclave] = lakey;
                        obj.push(objTEMP);

                    }
                    else {

                        objTEMP[laclave] = lakey.value;
                        obj.push(objTEMP);

                    }

					//alert('Type: ' + input.attr('type') + 'Name: ' + input.attr('name') + 'Value: ' + input.val());
				}
			);

	console.log(obj);

//alert(JSON.stringify(obj));
        var formData = JSON.stringify(obj);   //$("#theform").serializeArray();



        formData=replaceAll(formData,"&","_and_");


            console.log(formData);

            //determinar si guardar o update

            //if (document.getElementById("IDOBJECT").value != null) { updaterecord(convertJson(formData));  }

            if ($('#IDOBJECT').val() != '') { updaterecord(formData); }
            if ($('#IDOBJECT').val() == '' ) { guardarrecord(formData);  }

        }

        function numberWithCommas(n) {
            if (n != null) {
    var parts=n.toString().split(".");
            return parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",") + (parts[1] ? "." + parts[1] : "");

}
}

    function notificarcambioestatus(idobjetox) {

        $.ajax({
            async: true,
            url: "/notificarcambioestatus" + '?tabla=tblcotizacion&idobjeto=' + $('#IDOBJECT').val() + "&idestatus=" + $('#IDESTATUS_tblcotizacion').val()
                    }).then(function (data) {

                        var a = data;

                    });

        }

        function notificaralta(idobjetox) {

            $.ajax({
                 async: true,
                        url: "/notificaralta" + '?tabla=tblcotizacion&idobjeto=' +  $('#IDOBJECT').val()
                    }).then(function (data) {

                        var a = data;

                    });

        }

        function guardarrecord(datos) {

           // alert(JSON.stringify(datos));

                   $(document).ready(function () {
                    $.ajax({
                        url: "/saverecord" + '?objeto=' + datos + '&idusername=' + Cookies.get('idusername') + '&usuario=' + Cookies.get('username') + '&tipomov=nuevo&idobjeto=' +  $('#IDOBJECT').val()  + '&tabla=tblcotizacion&campokey=IDCOTIZACION'
                    ,
    error: function (request, error) {
        console.log(arguments);
        alert("No se guardó, hubo un error: verifique los datos que capturó. Confirme que no intenta registrar valores en campos que no admiten duplicados  ");
    }

                    }).then(function (data) {

                       // alert(data);
                        console.log(data);

                        //recuperando el ultimo ID de esta tabla
                         $(document).ready(function () {
                    $.ajax({
                        url: "/dameultimoid" + '?tablename=tblcotizacion'
                    }).then(function (data) {

                        $("#IDOBJECT").jqxInput('val', data);
                        $("#IDCOTIZACION").jqxInput('val', data) ;

                        notificaralta( $('#IDOBJECT').val() );
                        notificarcambioestatus( $('#IDOBJECT').val() );

                        aviso('El Registro ha sido guardado');

                        cargardatos2(data);

                        actualizardatos();

                    });
                         });

                    });
                });

        }

        function updaterecord(datos) {

           // alert(JSON.stringify(datos));

                   $(document).ready(function () {
                    $.ajax({
                        url: "/saverecord" + '?objeto=' + datos + '&idusername=' + Cookies.get('idusername') + '&usuario=' + Cookies.get('username') + '&tipomov=update&idobjeto=' + $('#IDOBJECT').val()  + '&tabla=tblcotizacion&campokey=IDCOTIZACION'
                    }).then(function (data) {

                       // alert(data);
                        console.log(data);

                        aviso('El Registro ha sido actualizado');

                        notificarcambioestatus( $('#IDOBJECT').val() );

                        cargardatos2($('#IDCOTIZACION').val() );

                        actualizardatos();

                    });
                });

        }

        function clonarregistro(){

            $("#IDOBJECT").jqxInput('val', '');
            $("#IDCOTIZACION").jqxInput('val', '');

            aviso("Pulse Guardar para terminar el proceso de clonación.");

        }

        function nuevoregistro() {
            var url_string = window.location.href;
            var url = new URL(url_string);
            var vistadetalle = url.searchParams.get("vistadetalle");
            var campofiltro = url.searchParams.get("campo1");
            var idobjetofiltro = url.searchParams.get("valor1");
            if (vistadetalle == 'true') {
                window.open('formrender?vistadetalle=true&campo1=' + campofiltro + '&valor1=' + idobjetofiltro + '&form=tables/tblcotizacion_form', '_self');
            } else {
                window.open('formrender?form=tables/tblcotizacion_form','_self');
            }
        }

        //rendergrid?grid=tables/tblcotizacion
        function regresarx() {
            var url_string = window.location.href;
            var url = new URL(url_string);
            var vistadetalle = url.searchParams.get("vistadetalle");
            var campofiltro = url.searchParams.get("campo1");
            var idobjetofiltro = url.searchParams.get("valor1");
            if (vistadetalle == 'true') {
                window.open('rendergrid?vistadetalle=true&campofiltro=' + campofiltro + '&idobjetofiltro=' + idobjetofiltro + '&grid=tables/tblcotizacion', '_self');
            } else {
                window.open('rendergrid?grid=tables/tblcotizacion','_self');
            }
        }

        function actualizardatos() {


            //ejecutar refrescador
                $.ajax({
                        url: "/refrescador" + '?tabla=tblcotizacion&idobjeto=' + $('#IDOBJECT').val()
                    }).then(function (data) {

                        aviso("Datos recalculados");

                    });





            var url_string = window.location.href;
            var url = new URL(url_string);
            var vistadetalle = url.searchParams.get("vistadetalle");
            var campofiltro = url.searchParams.get("campo1");
            var idobjetofiltro = url.searchParams.get("valor1");

        var tienehijos = true;

        if (tienehijos == true) {
            if ($('#IDCOTIZACION').val() != '') {
                window.open('formrender?form=tables/tblcotizacion_form&campo1=' + campofiltro + '&vistadetalle=true&valor1=' + idobjetofiltro + '&idobjeto=' + $('#IDCOTIZACION').val()  , '_self');
            }
            else {
            }
        }
        else {
                cargardatos2($('#IDCOTIZACION').val());
        }

        checaradjuntos();

        }

        function eliminarregistro() {

            $('#ELIMINADO').jqxCheckBox('val',  true);

        }

        function bloquear() {

            $('#BLOQUEADO').jqxCheckBox('val', true);
            setTimeout(() => { procesarguardado2(); }, 1000);

        }

        function desbloquear() {

            $('#BLOQUEADO').jqxCheckBox('val',  false);
            setTimeout(() => { procesarguardado2(); }, 1000);

        }

        function openid() {

            var elid = prompt("Escriba el ID del elemento");
            window.open('formrender?form=tables/tblcotizacion_form&idobjeto=' + elid, '_self');

        }
    </script>
    <div id="zonamenu">

    </div>

    <!--Titulo de la pagina-->
    <div id="zonatitulo">
        <h5 id="titulopagina" style="position:relative; top:5px;left:10px"> <table><tr><td> <a href="home"> <img src="/static/iconos/form.png" height="32" />  </a>    </td></td><td>Formulario de Cotización/Venta</td><td>/Id:</td><td><input class="inputx_idobject" id="IDOBJECT" type="text" style="width:125px;height:23px;font-size:19px;border-width: 0px;color:#2fa4e7;font-weight: 500;" /></td></tr></table></h5>
    </div>

    <!--Zona de Botones-->
    <script type="text/javascript">
        $(document).ready(function () {
            // Create jqxButton widgets.
            $("#Button1").jqxButton({ textPosition: "center", width: 120, theme: theme });
            $("#Button2").jqxButton({ textPosition: "center", width: 120, theme: theme });
            $("#Button3").jqxButton({ textPosition: "center", width: 120, theme: theme });
            $("#Button4").jqxButton({ textPosition: "center", width: 120, theme: theme });
            $("#Button5").jqxButton({ textPosition: "center", width: 120, theme: theme });
            $("#Button6").jqxButton({ textPosition: "center", width: 120, theme: theme });
            $("#Button7").jqxButton({ textPosition: "center", width: 120, theme: theme });
            $("#Button8").jqxButton({ textPosition: "center", width: 120, theme: theme });
            $("#Button9").jqxButton({ textPosition: "center", width: 120, theme: theme });



            $('#Button1').on('click', function () {


				var emailprospecto= ''  ;//dameemailprospecto();
               var lacoti=$('#IDOBJECT').val();
                window.open('static/stimulsoft/reportviewer.html?cuerpo=Estimado cliente&asunto=Envio de documento &para=' + emailprospecto + '&reporte=laventa.mrt&campofiltro=IDCOTIZACION&idobjetofiltro=' + lacoti ,'_blank');


            });
            $('#Button2').on('click', function () {

     var emailprospecto= ''  ;//dameemailprospecto();
				var lacoti=$('#IDOBJECT').val();
                window.open('static/stimulsoft/reportviewer.html?cuerpo=Estimado client@, le enviamos estado de cuenta los productos y servicios que tiene contratados o adquiridos con nosotros.&cuerpo=Estimado client@, le enviamos cotización de nuestros productos y servicios.&asunto=Envio de estado de cuenta&para=' + emailprospecto + '&reporte=venta.mrt&campofiltro=IDCOTIZACION&idobjetofiltro=' + lacoti ,'_blank');


            });
            $('#Button3').on('click', function () { 
            	
        
        
        
   	$.ajax({
	async: true,
	url: "/sqlexec2" + "?sentencia=call procesar_existencias_por_venta(" + $('#IDOBJECT').val() + ")&tablename=tblkardex&idusername=0"
	}).then(function (data) {


		alert("Existencias procesadas");

	
	});

        
        
        
            	
            });
            $('#Button4').on('click', function () {   });
            $('#Button5').on('click', function () {


            });
            $('#Button6').on('click', function () {

            });
            $('#Button7').on('click', function () {   });
            $('#Button8').on('click', function () {   });
            $('#Button9').on('click', function () {   });



        });
</script>

<div style="position:relative;left:700px;top:-35px;">
    <table>
        <tr>
            <td><input type="button" style="visibility:visible;position:relative;top:13px;" value="Cotiz/Venta" id='Button1' /></td>
            <td><input type="button" style="visibility:hidden;position:relative;top:13px;" value="Edo.Cta" id='Button2' /></td>
            <td><input type="button" style="visibility:visible;position:relative;top:13px;" value="Afectar Inventario" id='Button3' /></td>
            <td><input type="button" style="visibility:hidden;position:relative;top:13px;" value="TextButton" id='Button4' /></td>
            <td><input type="button" style="visibility:hidden;position:relative;top:13px;" value="TextButton" id='Button5' /></td>
            <td><input type="button" style="visibility:hidden;position:relative;top:13px;" value="TextButton" id='Button6' /></td>
            <td><input type="button" style="visibility:hidden;position:relative;top:13px;" value="TextButton" id='Button7' /></td>
            <td><input type="button" style="visibility:hidden;position:relative;top:13px;" value="TextButton" id='Button8' /></td>
            <td><input type="button" style="visibility:hidden;position:relative;top: 13px;"value="TextButton" id='Button9' /></td>
        </tr>
    </table>
</div>
<script>

function dameemailprospecto(){

	        $.ajax({
            async: false,
            url: "/obtenervalor?sentencia=SELECT  t2.EMAIL from tblcotizacion t1 inner join tblprospecto t2 on t1.IDPROSPECTO=t2.IDPROSPECTO where t1.IDCOTIZACION=" + $('#IDOBJECT').val()
                    }).then(function (data) {

                       resultado=data;

                    });



                    return String(resultado);

}


        
</script>

    <!--Form-->



    <script type="text/javascript">
        $(document).ready(function () {

            

         // Create jqxTabs.
            $('#tabs').jqxTabs({ autoHeight: true, width: '97%', position: 'top', theme: theme });

         $('#tabs').on('tabclick', function (event) {
     var tabclicked = event.args.item;

             var nombrex = 'hijo_' + (tabclicked-2);

             if (nombrex=='hijo_0') { document.getElementById('hijo_0').setAttribute('src','rendergrid?campofiltro=IDCOTIZACION&idobjetofiltro=' + document.getElementById('IDOBJECT').value + '&vistadetalle=true&grid=tables/tblcotizaciondeta'); } 


         });

            $("#IDCOTIZACION").jqxInput({  theme:theme , disabled:true, height: 25, width: 250 });
$("#IDPROSPECTO").jqxInput({theme:theme , disabled:false, dropDownWidth: 500, height: 25, width: 250, displayMember:"CAMPODISPLAY", valueMember:"IDPROSPECTO",source: function (query, response) {var dataAdapter = new $.jqx.dataAdapter({datatype: "json",datafields:[{ name: "CAMPODISPLAY" },{ name: "IDPROSPECTO" }],url: "populator?campofiltro=null&idobjetofiltro=null&tablename=tblPROSPECTO",data:{style: "full",maxRows: 25}},{autoBind: true,formatData: function (data) {data.CAMPODISPLAY_startsWith = query;return data;},loadComplete: function (data) {if (data.length > 0) {response($.map(data, function (item) {document.getElementById("bottom_IDPROSPECTO").innerHTML=""; return {label: item.CAMPODISPLAY,value: item.IDPROSPECTO}}));}}});}});    
$("#IDESTATUS_tblcotizacion").jqxInput({theme:theme , disabled:false, dropDownWidth: 500, height: 25, width: 250, displayMember:"CAMPODISPLAY", valueMember:"IDESTATUS_tblcotizacion",source: function (query, response) {var dataAdapter = new $.jqx.dataAdapter({datatype: "json",datafields:[{ name: "CAMPODISPLAY" },{ name: "IDESTATUS_tblcotizacion" }],url: "populator?campofiltro=null&idobjetofiltro=null&tablename=tblESTATUS_tblcotizacion",data:{style: "full",maxRows: 25}},{autoBind: true,formatData: function (data) {data.CAMPODISPLAY_startsWith = query;return data;},loadComplete: function (data) {if (data.length > 0) {response($.map(data, function (item) {document.getElementById("bottom_IDESTATUS_tblcotizacion").innerHTML=""; return {label: item.CAMPODISPLAY,value: item.IDESTATUS_tblcotizacion}}));}}});}});    
$("#PROCESADO").jqxCheckBox({ hasThreeStates:false, theme:theme , disabled:false,height: 25, width: 250 });
$("#FECHA").jqxDateTimeInput({ theme:theme ,disabled:false, height: 25, width: 250 });
$("#OBSERVACIONES").jqxTextArea({ theme:theme , disabled:false, height: 100, width: 250 });
$("#SUBTOTAL").jqxNumberInput({ theme:theme , disabled:false,max: 999999999999, digits: 25, height: 25, width: 250, inputMode:"simple", spinButtons: true });
$("#IMPORTE_IVA").jqxNumberInput({ theme:theme , disabled:false,max: 999999999999, digits: 25, height: 25, width: 250, inputMode:"simple", spinButtons: true });
$("#TOTAL").jqxNumberInput({ theme:theme , disabled:false,max: 999999999999, digits: 25, height: 25, width: 250, inputMode:"simple", spinButtons: true });
$("#IDCANALCOMERCIAL").jqxInput({theme:theme , disabled:false, dropDownWidth: 500, height: 25, width: 250, displayMember:"CAMPODISPLAY", valueMember:"IDCANALCOMERCIAL",source: function (query, response) {var dataAdapter = new $.jqx.dataAdapter({datatype: "json",datafields:[{ name: "CAMPODISPLAY" },{ name: "IDCANALCOMERCIAL" }],url: "populator?campofiltro=null&idobjetofiltro=null&tablename=tblCANALCOMERCIAL",data:{style: "full",maxRows: 25}},{autoBind: true,formatData: function (data) {data.CAMPODISPLAY_startsWith = query;return data;},loadComplete: function (data) {if (data.length > 0) {response($.map(data, function (item) {document.getElementById("bottom_IDCANALCOMERCIAL").innerHTML=""; return {label: item.CAMPODISPLAY,value: item.IDCANALCOMERCIAL}}));}}});}});    
$("#ELIMINADO").jqxCheckBox({ hasThreeStates:false, theme:theme , disabled:true,height: 25, width: 250 });
$("#BLOQUEADO").jqxCheckBox({ hasThreeStates:false, theme:theme , disabled:true,height: 25, width: 250 });
$("#FECHAALTA").jqxDateTimeInput({ theme:theme ,disabled:true, height: 25, width: 250 });
$("#PROPIETARIO").jqxInput({  theme:theme , disabled:false, height: 25, width: 250 });
$("#TOTAL_ABONOS").jqxNumberInput({ theme:theme , disabled:false,max: 999999999999, digits: 25, height: 25, width: 250, inputMode:"simple", spinButtons: true });
$("#TOTAL_ADEUDO").jqxNumberInput({ theme:theme , disabled:false,max: 999999999999, digits: 25, height: 25, width: 250, inputMode:"simple", spinButtons: true });


            $("#IDOBJECT").jqxInput({ height: 23, width: 125 });

             $('#theform').jqxValidator({ hintType: 'label', rules: [{ input: '#IDPROSPECTO', message: 'Campo requerido', action: 'keyup, blur', rule: 'required' },{ input: '#FECHA', message: 'Campo requerido', action: 'keyup, blur', rule: 'required' }]});

          cargardatos();

        });
    </script>

    <script>

         $(document).ready(function () {

           document.getElementById('hijo_0').src = 'rendergrid?campofiltro=IDCOTIZACION&idobjetofiltro=' + document.getElementById('IDOBJECT').value + '&vistadetalle=true&grid=tables/tblcotizaciondeta';  






             $("#button_grid").jqxButton({ textPosition: "center", width: 80, theme: theme });
            $("#button_nuevo").jqxButton({ textPosition: "center", width: 80, theme: theme });
            $("#button_guardar").jqxButton({ textPosition: "center", width: 80, theme: theme });
            $("#button_actualizar").jqxButton({ textPosition: "center", width: 80, theme: theme });
            $("#button_bloquear").jqxButton({ textPosition: "center", width: 80, theme: theme });
            $("#button_desbloquear").jqxButton({ textPosition: "center", width: 80, theme: theme });
            $("#button_clonar").jqxButton({ textPosition: "center", width: 80, theme: theme });
            $("#button_ir_id").jqxButton({ textPosition: "center", width: 80, theme: theme });
            $("#button_eliminar").jqxButton({ textPosition: "center", width: 80, theme: theme });
            $("#button_config").jqxButton({ textPosition: "center", width: 80   , theme: theme });




        });







    </script>

    <div style="position:relative;top:0px;" id='tabs'>
        <ul>
            <li style="margin-left: 30px;">Formulario</li>
            <li>Adjuntos & Notas</li>

            <li>Detalle de Cotización</li> 




        </ul>



        <div>

            <div style="position:relative;left:30px;top:8px">
                <table  id="tablabotones">
                    <tr>



                        <td   >
                            <a id="botonregresar" href="javascript:regresarx();">

                                <input type="button" id="button_grid" value="Ir al Grid" />
                            </a>
                        </td>



                          <td>
                            <a href="javascript: nuevoregistro();">
                                <input type="button" id="button_nuevo" value="Nuevo" />
                            </a>
                        </td>


                        <td    >
                            <a href="javascript:procesarguardado();">
                              <input type="button" id="button_guardar" value="Guardar" />
                            </a>
                        </td>



                        <td>
                            <a href="javascript:actualizardatos();">
                              <input type="button" id="button_actualizar" value="Actualizar" />
                            </a>
                        </td>

                        <td>
                            <a href="javascript:bloquear();">
                            <input type="button" id="button_bloquear" value="Bloquear" />
                            </a>
                        </td>

                        <td>
                            <a href="javascript:desbloquear();">
                                <input type="button" id="button_desbloquear" value="Desbloquear" />
                            </a>
                        </td>

                        <td>
                            <a href="javascript: clonarregistro();">
                           <input type="button" id="button_clonar" value="Clonar" />
                            </a>
                        </td>

                        <td>
                            <a href="javascript: openid();">
                      <input type="button" id="button_ir_id" value="Id al ID" />
                            </a>
                        </td>

                        <td  id="elimregs"   >
                            <a href="javascript: eliminarregistro();">
                             <input type="button" id="button_eliminar" value="Eliminar" />
                            </a>
                        </td>

                         <td>
                            <a target="_self" href="javascript:window.parent.parent.addtabplus('configcampos?tablename=tblcotizacion')">
                                <input type="button" id="button_config" value="Config" />
                            </a>
                        </td>
                    </tr>
                </table>
            </div>

            <hr />
            <form id="theform" name="theform">
                <table valign="top">
                    <tr valign="top">
                        <td valign="top"> <table class="ajustarposicion"><tr valign='top'   ><td  colspan='3'  ><h5>A. DATOS</h5> </tr><div  style="position:relative;left:10px" id="campoIDCOTIZACION" ><tr   class="filatop_IDCOTIZACION"  ><td><div id="top_IDCOTIZACION" /></td><td> <div id="slider" />  </td><td></td></tr><tr   class="filahalf_IDCOTIZACION" ><td class="caption_Id" >Id</td><td><input disabled  name="IDCOTIZACION" style="" class="input_IDCOTIZACION"  type="text" tabindex="1" id="IDCOTIZACION"/> </td><td> <div id="left_IDCOTIZACION" /> </td></tr><tr  class="filabottom_IDCOTIZACION" ><td><div id="bottom_IDCOTIZACION" /></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" ></div></td><td></td></tr></div>
<script>    function formadeabrir_IDPROSPECTO(){ if ($("#IDPROSPECTO").attr("data-value")!=null) { window.open("formrender?form=tables/tblprospecto_form&idobjeto=" + $("#IDPROSPECTO").attr("data-value") ,"_blank"); } else { window.open("rendergrid?grid=tables/tblprospecto","_blank"); }  }</script>  <script>   $(document).ready(function () { $("#combodown_IDPROSPECTO").click(function () { $('#IDPROSPECTO').focus();$('#IDPROSPECTO').val('');$('#IDPROSPECTO').focus();   simulateWrapper('#IDPROSPECTO', "key-sequence", {sequence: " "});           });});</script><div  style="position:relative;left:10px" id="campoIDPROSPECTO" ><tr   class="filatop_IDPROSPECTO"  ><td><div id="top_IDPROSPECTO" /></td><td></td><td></td></tr><tr   class="filahalf_IDPROSPECTO" ><td class="caption_Prospecto" >Prospecto</td><td> <input  name="IDPROSPECTO"  style="border-style: solid; border-top-width:0px; border-left-width:0px; border-right-width:0px; border-color: coral;"    class="input_IDPROSPECTO"  type="text" tabindex="2" id="IDPROSPECTO"/> </td><td> <img id="combodown_IDPROSPECTO" src="/static/iconos/dropdown.png" height="25px" width="25px" /><a href="javascript:formadeabrir_IDPROSPECTO(); " ><img  id="comboleft_IDPROSPECTO"  src="/static/iconos/adelante.png" height="25px" width="25px" /></a></td><td><div id="left_IDPROSPECTO" /> </td></tr><tr  class="filabottom_IDPROSPECTO" ><td></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" > </div><div id="bottom_IDPROSPECTO" /></td><td>    </td></tr></div>
 <script>  $(document).ready(function () { $("#combodown_IDESTATUS_tblcotizacion").click(function () { $('#IDESTATUS_tblcotizacion').focus();$('#IDESTATUS_tblcotizacion').val('');   simulateWrapper('#IDESTATUS_tblcotizacion', "key-sequence", {sequence: " "});           });});</script><div  style="position:relative;left:10px" id="campoIDESTATUS_tblcotizacion" ><tr   class="filatop_IDESTATUS_tblcotizacion"  ><td><div id="top_IDESTATUS_tblcotizacion" /></td><td></td><td></td></tr><tr   class="filahalf_IDESTATUS_tblcotizacion" ><td class="caption_Estatus" >Estatus</td><td> <input  name="IDESTATUS_tblcotizacion"  style=""    class="input_IDESTATUS_tblcotizacion"  type="text" tabindex="3" id="IDESTATUS_tblcotizacion"/> </td><td> <img id="combodown_IDESTATUS_tblcotizacion" src="/static/iconos/dropdown.png" height="25px" width="25px" /><a href="configstatus?tablename=tblcotizacion" target="_blank" ><img  id="comboleft_IDESTATUS_tblcotizacion"  src="/static/iconos/adelante.png" height="25px" width="25px" /></a></td><td><div id="left_IDESTATUS_tblcotizacion" /> </td></tr><tr  class="filabottom_IDESTATUS_tblcotizacion" ><td></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" > </div><div id="bottom_IDESTATUS_tblcotizacion" /></td><td>    </td></tr></div>
 <div  style="position:relative;left:10px" id="campoPROCESADO" ><tr   class="filatop_PROCESADO"  ><td><div id="top_PROCESADO" /></td><td></td><td></td></tr><tr   class="filahalf_PROCESADO" ><td class="caption_Procesado" >Procesado</td><td> <div  name="PROCESADO"    style="border-radius:6px;"  class="input_PROCESADO" tabindex="4" id="PROCESADO"/> </td><td><div id="left_PROCESADO" /> </td></tr><tr  class="filabottom_PROCESADO" ><td><div id="bottom_PROCESADO" /></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" ></div> </td><td></td></tr></div>
<div  style="position:relative;left:10px" id="campoFECHA" ><tr   class="filatop_FECHA"  ><td><div id="top_FECHA" /></td><td></td><td></td></tr><tr   class="filahalf_FECHA" ><td class="caption_Fecha" >Fecha</td><td> <div  name="FECHA"    style="border-radius:6px;border-style: solid; border-top-width:0px; border-left-width:0px; border-right-width:0px; border-color: coral;"  class="input_FECHA" tabindex="5" id="FECHA"/> </td><td><div id="left_FECHA" /> </td></tr><tr  class="filabottom_FECHA" ><td><div id="bottom_FECHA" /></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" ></div></td><td></td></tr></div>
<div  style="position:relative;left:10px" id="campoOBSERVACIONES" ><tr   class="filatop_OBSERVACIONES"  ><td><div id="top_OBSERVACIONES" /></td><td></td><td></td></tr><tr   class="filahalf_OBSERVACIONES" ><td valign="Top" class="caption_Observaciones" >Observaciones</td><td> <textarea   name="OBSERVACIONES"   style=""  class="input_OBSERVACIONES" tabindex="6" id="OBSERVACIONES"></textarea></td><td><a href='javascript:startRecording("OBSERVACIONES");' > <img id="microphone_OBSERVACIONES" src="/static/iconos/mic.png"  /> </a> <div id="left_OBSERVACIONES" /> </td></tr><tr  class="filabottom_OBSERVACIONES" ><td><div id="bottom_OBSERVACIONES" /></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" ></div> </td><td></td></tr></div>
<tr valign='top'   ><td  colspan='3'  ><h5>C. CANAL</h5> </tr><script>    function formadeabrir_IDCANALCOMERCIAL(){ if ($("#IDCANALCOMERCIAL").attr("data-value")!=null) { window.open("formrender?form=tables/tblcanalcomercial_form&idobjeto=" + $("#IDCANALCOMERCIAL").attr("data-value") ,"_blank"); } else { window.open("rendergrid?grid=tables/tblcanalcomercial","_blank"); }  }</script>  <script>   $(document).ready(function () { $("#combodown_IDCANALCOMERCIAL").click(function () { $('#IDCANALCOMERCIAL').focus();$('#IDCANALCOMERCIAL').val('');$('#IDCANALCOMERCIAL').focus();   simulateWrapper('#IDCANALCOMERCIAL', "key-sequence", {sequence: " "});           });});</script><div  style="position:relative;left:10px" id="campoIDCANALCOMERCIAL" ><tr   class="filatop_IDCANALCOMERCIAL"  ><td><div id="top_IDCANALCOMERCIAL" /></td><td></td><td></td></tr><tr   class="filahalf_IDCANALCOMERCIAL" ><td class="caption_CanalComercial" >Canal Comercial</td><td> <input  name="IDCANALCOMERCIAL"  style=""    class="input_IDCANALCOMERCIAL"  type="text" tabindex="42" id="IDCANALCOMERCIAL"/> </td><td> <img id="combodown_IDCANALCOMERCIAL" src="/static/iconos/dropdown.png" height="25px" width="25px" /><a href="javascript:formadeabrir_IDCANALCOMERCIAL(); " ><img  id="comboleft_IDCANALCOMERCIAL"  src="/static/iconos/adelante.png" height="25px" width="25px" /></a></td><td><div id="left_IDCANALCOMERCIAL" /> </td></tr><tr  class="filabottom_IDCANALCOMERCIAL" ><td></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" > </div><div id="bottom_IDCANALCOMERCIAL" /></td><td>    </td></tr></div>
 <tr valign='top'   ><td  colspan='3'  ><h5>Z. ABONOS</h5> </tr><div  style="position:relative;left:10px" id="campoTOTAL_ABONOS" ><tr   class="filatop_TOTAL_ABONOS"  ><td><div id="top_TOTAL_ABONOS" /></td><td></td><td></td></tr><tr   class="filahalf_TOTAL_ABONOS" ><td class="caption_TotalAbonos" >Total Abonos</td><td> <div  name="TOTAL_ABONOS"  style="border-radius:6px;"  class="input_TOTAL_ABONOS" tabindex="79" id="TOTAL_ABONOS"/> </td> <td> <a href='javascript:startRecording("TOTAL_ABONOS");' > <img id="microphone_TOTAL_ABONOS" src="/static/iconos/mic.png"  /> </a> <div id="left_TOTAL_ABONOS" /> </td></tr><tr  class="filabottom_TOTAL_ABONOS" ><td></td><td align="right"  style="position:relative;left:-26px" ><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;position:relative;left:-150px;" ></div> <div style="display:None;" id="bottom_TOTAL_ABONOS" /></td><td></td></tr></div>
<div  style="position:relative;left:10px" id="campoTOTAL_ADEUDO" ><tr   class="filatop_TOTAL_ADEUDO"  ><td><div id="top_TOTAL_ADEUDO" /></td><td></td><td></td></tr><tr   class="filahalf_TOTAL_ADEUDO" ><td class="caption_TotalAdeudo" >Total Adeudo</td><td> <div  name="TOTAL_ADEUDO"  style="border-radius:6px;"  class="input_TOTAL_ADEUDO" tabindex="80" id="TOTAL_ADEUDO"/> </td> <td> <a href='javascript:startRecording("TOTAL_ADEUDO");' > <img id="microphone_TOTAL_ADEUDO" src="/static/iconos/mic.png"  /> </a> <div id="left_TOTAL_ADEUDO" /> </td></tr><tr  class="filabottom_TOTAL_ADEUDO" ><td></td><td align="right"  style="position:relative;left:-26px" ><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;position:relative;left:-150px;" ></div> <div style="display:None;" id="bottom_TOTAL_ADEUDO" /></td><td></td></tr></div>
</table></td>
                        <td valign="top"> <table class="ajustarposicion"><tr valign='top'   ><td  colspan='3'  ><h5>B. IMPORTES</h5> </tr><div  style="position:relative;left:10px" id="campoSUBTOTAL" ><tr   class="filatop_SUBTOTAL"  ><td><div id="top_SUBTOTAL" /></td><td></td><td></td></tr><tr   class="filahalf_SUBTOTAL" ><td class="caption_Subtotal" >Subtotal</td><td> <div  name="SUBTOTAL"  style="border-radius:6px;"  class="input_SUBTOTAL" tabindex="23" id="SUBTOTAL"/> </td> <td> <a href='javascript:startRecording("SUBTOTAL");' > <img id="microphone_SUBTOTAL" src="/static/iconos/mic.png"  /> </a> <div id="left_SUBTOTAL" /> </td></tr><tr  class="filabottom_SUBTOTAL" ><td></td><td align="right"  style="position:relative;left:-26px" ><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;position:relative;left:-150px;" ></div> <div style="display:None;" id="bottom_SUBTOTAL" /></td><td></td></tr></div>
<div  style="position:relative;left:10px" id="campoIMPORTE_IVA" ><tr   class="filatop_IMPORTE_IVA"  ><td><div id="top_IMPORTE_IVA" /></td><td></td><td></td></tr><tr   class="filahalf_IMPORTE_IVA" ><td class="caption_ImporteIva" >Importe Iva</td><td> <div  name="IMPORTE_IVA"  style="border-radius:6px;"  class="input_IMPORTE_IVA" tabindex="24" id="IMPORTE_IVA"/> </td> <td> <a href='javascript:startRecording("IMPORTE_IVA");' > <img id="microphone_IMPORTE_IVA" src="/static/iconos/mic.png"  /> </a> <div id="left_IMPORTE_IVA" /> </td></tr><tr  class="filabottom_IMPORTE_IVA" ><td></td><td align="right"  style="position:relative;left:-26px" ><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;position:relative;left:-150px;" ></div> <div style="display:None;" id="bottom_IMPORTE_IVA" /></td><td></td></tr></div>
<div  style="position:relative;left:10px" id="campoTOTAL" ><tr   class="filatop_TOTAL"  ><td><div id="top_TOTAL" /></td><td></td><td></td></tr><tr   class="filahalf_TOTAL" ><td class="caption_Total" >Total</td><td> <div  name="TOTAL"  style="border-radius:6px;"  class="input_TOTAL" tabindex="25" id="TOTAL"/> </td> <td> <a href='javascript:startRecording("TOTAL");' > <img id="microphone_TOTAL" src="/static/iconos/mic.png"  /> </a> <div id="left_TOTAL" /> </td></tr><tr  class="filabottom_TOTAL" ><td></td><td align="right"  style="position:relative;left:-26px" ><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;position:relative;left:-150px;" ></div> <div style="display:None;" id="bottom_TOTAL" /></td><td></td></tr></div>
<tr valign='top'   ><td  colspan='3'  ><h5>X. CONTROL</h5> </tr><div  style="position:relative;left:10px" id="campoELIMINADO" ><tr   class="filatop_ELIMINADO"  ><td><div id="top_ELIMINADO" /></td><td></td><td></td></tr><tr   class="filahalf_ELIMINADO" ><td class="caption_Eliminado" >Eliminado</td><td> <div  name="ELIMINADO"    style="border-radius:6px;"  class="input_ELIMINADO" tabindex="59" id="ELIMINADO"/> </td><td><div id="left_ELIMINADO" /> </td></tr><tr  class="filabottom_ELIMINADO" ><td><div id="bottom_ELIMINADO" /></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" ></div> </td><td></td></tr></div>
<div  style="position:relative;left:10px" id="campoBLOQUEADO" ><tr   class="filatop_BLOQUEADO"  ><td><div id="top_BLOQUEADO" /></td><td></td><td></td></tr><tr   class="filahalf_BLOQUEADO" ><td class="caption_Bloqueado" >Bloqueado</td><td> <div  name="BLOQUEADO"    style="border-radius:6px;"  class="input_BLOQUEADO" tabindex="60" id="BLOQUEADO"/> </td><td><div id="left_BLOQUEADO" /> </td></tr><tr  class="filabottom_BLOQUEADO" ><td><div id="bottom_BLOQUEADO" /></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" ></div> </td><td></td></tr></div>
<div  style="position:relative;left:10px" id="campoFECHAALTA" ><tr   class="filatop_FECHAALTA"  ><td><div id="top_FECHAALTA" /></td><td></td><td></td></tr><tr   class="filahalf_FECHAALTA" ><td class="caption_FechaAlta" >Fecha Alta</td><td> <div  name="FECHAALTA"    style="border-radius:6px;"  class="input_FECHAALTA" tabindex="61" id="FECHAALTA"/> </td><td><div id="left_FECHAALTA" /> </td></tr><tr  class="filabottom_FECHAALTA" ><td><div id="bottom_FECHAALTA" /></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" ></div></td><td></td></tr></div></div>
<div  style="position:relative;left:10px" id="campoPROPIETARIO" ><tr   class="filatop_PROPIETARIO"  ><td><div id="top_PROPIETARIO" /></td><td></td><td></td></tr><tr   class="filahalf_PROPIETARIO" ><td class="caption_Propietario" >Propietario</td><td><input   name="PROPIETARIO" style="" class="input_PROPIETARIO"  type="text" tabindex="62" id="PROPIETARIO"/> </td><td>    <div id="left_PROPIETARIO" /> </td></tr><tr  class="filabottom_PROPIETARIO" ><td><div id="bottom_PROPIETARIO" /></td><td><div  style="font-size:10px;margin-bottom: 5px;font-style: italic;color: navy;font-variant: all-small-caps;;" ></div></td><td></td></tr></div>
</table></td>
                    </tr>
                </table>
            </form>

            <!--Espacio vacio-->
            <div style="height:100px"></div>
        </div>

        <div style="height:1200px;overflow: hidden">
            <div style="position:relative;left:30px">

                <hr />
                <h5>Archivos adjuntos asociados al registro</h5>

                <hr>
                <form action="upload" method="post" id="misfiles" enctype="multipart/form-data">
                    <input type="file" multiple="" name="file[]" width="150" /><br /><br />
                    <input type="button" onclick="enviardatos();" width="150" value="Subir archivos " />
                </form>

                <hr />

                <h5>Lista de Archivos</h5>

                <div id="misarchivosdiv"></div>

                <script>

                    function enviardatos() {

            var url_string = window.location.href;
            var url = new URL(url_string);
                        var campo1 = url.searchParams.get("campo1");
                        var valor1 = url.searchParams.get("valor1");
                        var vistadetalle = url.searchParams.get("vistadetalle");

                if ($('#IDOBJECT').val() != null) {
                document.getElementById("misfiles").action = "upload?campo1=" + campo1 + "&valor1=" + valor1 + "&vistadetalle=" + vistadetalle + "&tabla=tblcotizacion&objeto=" + $('#IDOBJECT').val();
                document.getElementById("misfiles").submit();}

                }

                    function damefiles() {


                $(document).ready(function () {
                    $.ajax({
                        url: "/damefiles" + '?tabla=tblcotizacion&idobjeto=' + $('#IDOBJECT').val()
                    }).then(function (data) {

                        datos = String(data);

                        datos = datos.replace('&para=', '&para=' + $("#EMAIL").val());



                        document.getElementById('misarchivosdiv').innerHTML = datos;




                    });
                });



                $(document).ready(function () {
                    $.ajax({
                        url: "/damefilesslider" + '?tabla=tblcotizacion&idobjeto=' + $('#IDOBJECT').val()
                    }).then(function (data) {

                        $('#slider').css("'visibility': 'hidden'");
                        if (data.length > 10) {

                            document.getElementById('slider').innerHTML = data;
                            $('#slider').css("'visibility': 'visible'");
                        }


                    });
                });







                }

                //volcando archivos
                 damefiles();
                </script>


            </div>


        </div>

        <div> <embed  src='rendergrid?campofiltro=IDCOTIZACION&idobjetofiltro=' + document.getElementById('IDOBJECT').value + '&vistadetalle=true&grid=tables/tblcotizaciondeta'  id='hijo_0' style='width:100%' height='1200'  />  </div> 

    </div>

    <script>
$(document).ready(function () { $("#IDCOTIZACION").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   // var value = $("#IDCOTIZACION").val(); 
 });}); 

 $(document).ready(function () { $("#IDPROSPECTO").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   // var value = $("#IDPROSPECTO").val(); 
 });}); 

 $(document).ready(function () { $("#OBSERVACIONES").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   // var value = $("#OBSERVACIONES").val(); 
 });}); 

 $(document).ready(function () { $("#IDESTATUS_tblcotizacion").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   // var value = $("#IDESTATUS_tblcotizacion").val(); 
 });}); 

 $(document).ready(function () { $("#FECHA").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   // var value = $("#FECHA").val(); 
 });}); 

 $(document).ready(function () { $("#SUBTOTAL").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   var value = $("#SUBTOTAL").val(); 
  $("#bottom_SUBTOTAL").html(numberWithCommas(value));      });}); 

 $(document).ready(function () { $("#IMPORTE_IVA").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   var value = $("#IMPORTE_IVA").val(); 
  $("#bottom_IMPORTE_IVA").html(numberWithCommas(value));      });}); 

 $(document).ready(function () { $("#TOTAL").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   var value = $("#TOTAL").val(); 
  $("#bottom_TOTAL").html(numberWithCommas(value));      });}); 

 $(document).ready(function () { $("#ELIMINADO").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   // var value = $("#ELIMINADO").val(); 
 });}); 

 $(document).ready(function () { $("#BLOQUEADO").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   // var value = $("#BLOQUEADO").val(); 
 });}); 

 $(document).ready(function () { $("#FECHAALTA").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   // var value = $("#FECHAALTA").val(); 
 });}); 

 $(document).ready(function () { $("#PROPIETARIO").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   // var value = $("#PROPIETARIO").val(); 
 });}); 

 $(document).ready(function () { $("#TOTAL_ABONOS").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   var value = $("#TOTAL_ABONOS").val(); 
  $("#bottom_TOTAL_ABONOS").html(numberWithCommas(value));      });}); 

 $(document).ready(function () { $("#TOTAL_ADEUDO").on("change", 
 function (event) { 
 // var type = event.args.type; // keyboard, mouse or null depending on how the value was changed. 
   var value = $("#TOTAL_ADEUDO").val(); 
  $("#bottom_TOTAL_ADEUDO").html(numberWithCommas(value));      });}); 

 </script>

    

    <div id="notificar">
        <div id="textonotificacion">
            Welcome to our website.
        </div>
    </div>





    <script>

        function delfile(ruta) {

             $.ajax({
            async: true,
            url: ruta
                    }).then(function (data) {

                        if (data == 'ok') {
                            aviso("Archivo Eliminado");
                            document.getElementById('misarchivosdiv').innerHTML = '';
                            damefiles();
                        }

                    });

        }



        $(document).ready(function () {

            $("#notificar").jqxNotification({
                width: 250, position: "top-right", opacity: 0.9,
                autoOpen: false, animationOpenDelay: 800, autoClose: true, autoCloseDelay: 3000, theme:theme  , blink:false, template: "info"
            });

                var url_string = window.location.href;
                var url = new URL(url_string);
                var campo1 = url.searchParams.get("campo1");
                var valor1 = url.searchParams.get("valor1");
                var campo2 = url.searchParams.get("campo2");
                var valor2 = url.searchParams.get("valor2");
                var campo3 = url.searchParams.get("campo3");
                var valor3 = url.searchParams.get("valor3");
                var campo4 = url.searchParams.get("campo4");
                var valor4 = url.searchParams.get("valor4");
                var campo5 = url.searchParams.get("campo5");
                var valor5 = url.searchParams.get("valor5");
                var campo6 = url.searchParams.get("campo6");
                var valor6 = url.searchParams.get("valor6");
                var campo7 = url.searchParams.get("campo7");
                var valor7 = url.searchParams.get("valor7");
                var campo8 = url.searchParams.get("campo8");
                var valor8 = url.searchParams.get("valor8");
                var campo9 = url.searchParams.get("campo9");
                var valor9 = url.searchParams.get("valor9");
                var campo10 = url.searchParams.get("campo10");
                var valor10 = url.searchParams.get("valor10");

                if (campo1 != 'null' && campo1 != null ) { $("#" + campo1).jqxInput('val', valor1); }
                if (campo2 != 'null' && campo2 != null ) { $("#" + campo2).jqxInput('val', valor2); }
                if (campo3 != 'null' && campo3 != null ) { $("#" + campo3).jqxInput('val', valor3); }
                if (campo4 != 'null' && campo4 != null ) { $("#" + campo4).jqxInput('val', valor4); }
                if (campo5 != 'null' && campo5 != null ) { $("#" + campo5).jqxInput('val', valor5); }
                if (campo6 != 'null' && campo6 != null ) { $("#" + campo6).jqxInput('val', valor6); }
                if (campo7 != 'null' && campo7 != null ) { $("#" + campo7).jqxInput('val', valor7); }
                if (campo8 != 'null' && campo8 != null ) { $("#" + campo8).jqxInput('val', valor8); }
                if (campo9 != 'null' && campo9 != null ) { $("#" + campo9).jqxInput('val', valor9); }
                if (campo10 != 'null' && campo10 != null ) { $("#" + campo10).jqxInput('val', valor10); }

            var url_string = window.location.href;
            var url = new URL(url_string);
            var vistadetalle = url.searchParams.get("vistadetalle");

           // if ( window.location !== window.parent.location ) {
  // The page is in an iframe
         //   } else {
  // The page is not in an iframe
       //     }

                if (vistadetalle == 'true' && window.location !== window.parent.location  ) {

               // document.getElementById('zonatitulo').style.display = 'none';
                document.getElementById('zonamenu').style.display = 'none';
            }

                verificar();

                checaradjuntos();

            });

            function verificar() {

           //disable si no hay un IDOBJECT
                 if (document.getElementById('IDOBJECT').value=='') { $('#tabs').jqxTabs('disableAt', 2);  } 


            }

           function checaradjuntos() {

                        if ( $('#IDCOTIZACION').val()    != '') {
                    $('#tabs').jqxTabs('enableAt', 1);
                } else {
                    $('#tabs').jqxTabs('disableAt', 1);
                }

            }
    </script>

    <style>	h5{	color: #982d2d;    font-family: pompadour; font-size: 19px;    font-variant: small-caps;}	td{		color:#0014ff	;    font-family: pompadour;}</style>







    <script>


        $(document).ready(function () {
            document.getElementsByTagName("html")[0].style.visibility = "visible";











        });

window.parent.parent.tabtitle('Formulario de Cotización/Venta');

        //Cargando datos del objeto
        var url_string = window.location.href;
        var url = new URL(url_string);
        var idobjeto = url.searchParams.get("idobjeto");



        if (idobjeto != null && idobjeto != 'null'  && idobjeto != ''  && idobjeto != ' '  ) {
         window.parent.parent.tabtitle('Formulario de Cotización/Venta' + ' ' + idobjeto );
        }




    </script>


   
<script>
  
</script>

</body>
</html>